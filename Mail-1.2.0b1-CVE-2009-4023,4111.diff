
 http://pear.php.net/bugs/bug.php?id=16200

--- Mail-1.2.0b1/Mail/sendmail.php	2008-07-02 02:24:39.000000000 -0400
+++ Mail-1.2.0b1/Mail/sendmail.php.oden	2010-01-25 06:27:54.000000000 -0500
@@ -117,7 +117,7 @@ class Mail_sendmail extends Mail {
         if (is_a($recipients, 'PEAR_Error')) {
             return $recipients;
         }
-        $recipients = escapeShellCmd(implode(' ', $recipients));
+        $recipients = implode(' ', array_map('escapeshellarg', $recipients));
 
         $headerElements = $this->prepareHeaders($headers);
         if (is_a($headerElements, 'PEAR_Error')) {
@@ -141,7 +141,7 @@ class Mail_sendmail extends Mail {
             return PEAR::raiseError('From address specified with dangerous characters.');
         }
 
-        $from = escapeShellCmd($from);
+        $from = escapeShellArg($from);
         $mail = @popen($this->sendmail_path . (!empty($this->sendmail_args) ? ' ' . $this->sendmail_args : '') . " -f$from -- $recipients", 'w');
         if (!$mail) {
             return PEAR::raiseError('Failed to open sendmail [' . $this->sendmail_path . '] for execution.');
--- Mail-1.2.0b1/Mail.xml	2008-07-02 02:24:39.000000000 -0400
+++ Mail-1.2.0b1/Mail.xml.oden	2010-01-25 06:47:32.000000000 -0500
@@ -34,7 +34,7 @@
    <file md5sum="42fbd507adb3bc0af902ed741746807c" name="Mail/mock.php" role="php" />
    <file md5sum="4a1ed7ae8036862b24fa0ea84f8bbe0e" name="Mail/null.php" role="php" />
    <file md5sum="1e8ea8c17e3a9c9c2bd1c7e7ff73f9b1" name="Mail/RFC822.php" role="php" />
-   <file md5sum="3abc6b47b8c5ad44a9f6cfa377665808" name="Mail/sendmail.php" role="php" />
+   <file md5sum="91dd3b2c91bee6eb2f795c6e15a7d2b3" name="Mail/sendmail.php" role="php" />
    <file md5sum="e1fec8ec1daf8a6bcbbee83b9eb84ac0" name="Mail/smtp.php" role="php" />
    <file md5sum="b83dd46d9d81cbcd9727c2976e674b25" name="Mail/smtpmx.php" role="php" />
    <file md5sum="bbd88a5dfb0536a8c66ba07a1fbda382" name="tests/rfc822.phpt" role="test" />
